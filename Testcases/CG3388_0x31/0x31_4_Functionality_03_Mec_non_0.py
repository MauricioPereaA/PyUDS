
            # This is and autogenerated test case using PyUDS Test Builder v0.3 #
#Modified by: Mauricio Perea        Date: 5-Nov-20
        
from framework.shared_functions import tools, device_under_test
from Testcases.TestClass import TestCase
from inspect import stack as info
import unittest, time

test = TestCase()
class PyUDS_TestCase(unittest.TestCase):

    #== PyUDS - Autogenerated Test Case Template ==#
    @classmethod
    def setUpClass(self):
        #== Initialize test case ==#
        test.begin(
            test_info=info(),
            writeTestResults=True,
            excel_tab='0x31'
        )
		
        self.all_FFs_byte_seed = ' '.join(('FF '*31).split())
    @classmethod
    def tearDownClass(self):
        #== End Test Case ==#
        test.end()

    def test_084(self, name='<Transition to extendedSession>'):
        test.preconditions(
            step_info=info(),
            mec_zero=False, 
            sbat=False   
        )
        test.step(
            step_title=name,
            custom='10 03',
            expected={
                'response': 'Positive',
                'dataLength': '4'
            }
        )

    def test_085(self, name='<Activate TesterPresent>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            start_tester_present=True,
            expected={
                'response': 'No response'
            }
        )
    def test_087(self, name='<Start Routine> Physical Address Req'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            custom='31 01 02 1E',
            expected={
                'response': 'Negative',
                'data': '33'
            }
        )

    def test_088(self, name='<Unlock Security Level 01, ServiceProgramming>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            request_seed='01',
            expected={
                'response': 'Positive',
                'data': self.all_FFs_byte_seed
            }
        )

    def test_089(self, name='<Unlock the Server via security access 01 service>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            send_key='01',
            expected={
                'response': 'Positive'
            }
        )

    def test_090(self, name='<Verify Server is enforcing ECU Service Programming Routine>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            custom='31 01 02 1E',
            expected={
                'response': 'Positive'
            }
        )

    def test_091(self, name='Send valid testerPresent, service 3E, within P3 for 2 minutes + Stop periodically transmitted TesterPresent and wait for S3 Timeout + 100 msec, 5.1 seconds, for the Session Timing parameter to timeout'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            start_tester_present=True,
            expected={
                'response': 'No response'
            }
        )
        tools.timer.input('Wait for 2 minutes...', timeout=120)
        test.preconditions(current_step='- Stop tester present -')
        test.step(step_title='- Stop tester present -',
                    stop_tester_present=True)
        tools.timer.input('Wait for S3 Timeout + 100ms', timeout=6)


    def test_093(self, name='<Verify return to defaultSession>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            custom='28 03 01',
            expected={
                'response': 'Negative',
                'data': '7F'
            }
        )

    def test_094(self, name='<Transition to extendedSession>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            custom='10 03',
            expected={
                'response': 'Positive',
                'dataLength': '4'
            }
        )

    def test_095(self, name='<Activate TesterPresent>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            start_tester_present=True,
            expected={
                'response': 'No response'
            }
        )

    def test_097(self, name='<Start Routine> Physical Address Req'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            custom='31 01 02 1E',
            expected={
                'response': 'Negative',
                'data': '33'
            }
        )

    def test_098(self, name='<Unlock Security Level 03, ServiceProgramming>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            request_seed='03',
            expected={
                'response': 'Positive',
                'data': self.all_FFs_byte_seed
            }
        )

    def test_099(self, name='<Unlock the Server via security access 03 service>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            send_key='03',
            expected={
                'response': 'Positive'
            }
        )

    def test_100(self, name='<Verify Server is enforcing ECU Service Programming Routine>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            custom='31 01 02 1E',
            expected={
                'response': 'Positive'
            }
        )

    def test_101(self, name='Send valid testerPresent, service 3E, within P3 for 2 minutes + Stop periodically transmitted TesterPresent and wait for S3 Timeout + 100 msec, 5.1 seconds, for the Session Timing parameter to timeout'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            start_tester_present=True,
            expected={
                'response': 'No response'
            }
        )
        tools.timer.input('Wait for 2 minutes...', timeout=120)
        test.preconditions(current_step='- Stop tester present -')
        test.step(step_title='- Stop tester present -',
                    stop_tester_present=True)
        tools.timer.input('Wait for S3 Timeout + 100ms', timeout=6)

    def test_103(self, name='<Verify return to defaultSession>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            custom='28 03 01',
            expected={
                'response': 'Negative',
                'data': '7F'
            }
        )

    def test_104(self, name='<Transition to extendedSession>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            custom='10 03',
            expected={
                'response': 'Positive',
                'dataLength': '4'
            }
        )

    def test_105(self, name='<Activate TesterPresent>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            start_tester_present=True,
            expected={
                'response': 'No response'
            }
        )

    def test_110(self, name='<Start Routine> Physical Address Req'):
        if device_under_test is 'SCL':
            print('This test is not applicable for %s'%device_under_test)
            return 0
        test.preconditions(
            step_info=info()
        )
        if device_under_test is 'MSM':
            test.step(
                step_title=name,
                custom='31 01 02 7A 02',
                expected={
                    'response': 'Negative',
                    'data': '33'
                }
            )
        if device_under_test in ['ARB','TCP']:
            test.step(
                step_title=name,
                custom='31 01 02 C0 00',
                expected={
                    'response': 'Negative',
                    'data': '33'
                }
            )
        if device_under_test == 'PTM':#no suitable rid
            test.step(
                step_title=name,
                custom='31 01 03 42 00 00',
                expected={
                    'response': 'Negative',
                    'data': '33'
                }
            ) 
    def test_111(self, name='<Unlock Security Level 09, ServiceProgramming>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            request_seed='09',
            expected={
                'response': 'Positive',
                'data': self.all_FFs_byte_seed
            }
        )

    def test_112(self, name='<Unlock the Server via security access 09 service>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            send_key='09',
            expected={
                'response': 'Positive'
            }
        )

    def test_113(self, name='<Verify Server is enforcing ECU Service Programming Routine>'):
        test.preconditions(
            step_info=info()
        )
        if device_under_test is 'MSM':
            test.step(
                step_title=name,
                custom='31 01 02 7A 02',#31 01 02 7A 01 --> 22 4B 4E
                expected={
                    'response': 'Positive'
                }
            )
        if device_under_test is 'SCL':
            test.step(
                step_title=name,
                custom='31 01 FF 01',
                expected={
                    'response': 'Positive'
                }
            )
        if device_under_test in ['ARB','TCP']:
            test.step(
                step_title=name,
                custom='31 01 02 C0 00',
                expected={
                    'response': 'Positive'
                }
            )
        if device_under_test == 'PTM': #no suitable rid
            test.preconditions(
                step_info=info(),
                signal=['RCIP_RrClsrMtnCtlParmEnblAuth','SrlDat2_Prtctd_PDU',1]                
                ) 
            time.sleep(5)           
            test.step(
                step_title=name,
                custom='31 01 03 42 00 00',
                expected={
                    'response': 'Positive'
                }
            )
    def test_114(self, name='Send valid testerPresent, service 3E, within P3 for 2 minutes + Stop periodically transmitted TesterPresent and wait for S3 Timeout + 100 msec, 5.1 seconds, for the Session Timing parameter to timeout'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            start_tester_present=True,
            expected={
                'response': 'No response'
            }
        )
        tools.timer.input('Wait for 2 minutes...', timeout=120)
        test.preconditions(current_step='- Stop tester present -')
        test.step(step_title='- Stop tester present -',
                    stop_tester_present=True)
        tools.timer.input('Wait for S3 Timeout + 100ms', timeout=6)

    def test_116(self, name='<Verify return to defaultSession>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            custom='28 03 01',
            expected={
                'response': 'Negative',
                'data': '7F'
            }
        )

    def test_117(self, name='<Transition to extendedSession>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            custom='10 03',
            expected={
                'response': 'Positive',
                'dataLength': '4'
            }
        )

    def test_118(self, name='<Activate TesterPresent>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            start_tester_present=True,
            expected={
                'response': 'No response'
            }
        )

    def test_120(self, name='<Start Routine> Physical Address Req'):
        if device_under_test is 'SCL':
            print(name, 'Test is not applicable for %s'%device_under_test)
            return 0
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            custom='NOT APLICABLE', #no suitable RID for MSM and PTM
            expected={
                'response': 'Negative',
                'data': '33'
            }
        )

    def test_121(self, name='<Unlock Security Level 0B, ServiceProgramming>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            request_seed='0B',
            expected={
                'response': 'Positive',
                'data': self.all_FFs_byte_seed
            }
        )

    def test_122(self, name='<Unlock the Server via security access 0B service>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            send_key='0B',
            expected={
                'response': 'Positive'
            }
        )

    def test_123(self, name='<Verify Server is enforcing ECU Service Programming Routine>'):
        test.preconditions(
            step_info=info()
        )
        if device_under_test is 'MSM':
            test.step(
                step_title=name,
                custom='NOT APLICABLE', #no suitable RID for MSM and PTM
                expected={
                    'response': 'Positive'
                }
            )
        if device_under_test is 'SCL':
            test.step(
                step_title=name,
                custom='31 01 FF 01',
                expected={
                    'response': 'Positive'
                }
            )
        if device_under_test == 'TCP':
            test.step(
                step_title=name,
                custom='31 01 02 C0 00',
                expected={
                    'response': 'Positive'
                }
            )
        if device_under_test in ['PTM','ARB']:
            test.step(
                step_title=name,
                custom='NOT APLICABLE', #no suitable RID for MSM and PTM
                expected={
                    'response': 'Positive'
                }
            )
    def test_124(self, name='Send valid testerPresent, service 3E, within P3 for 2 minutes + Stop periodically transmitted TesterPresent and wait for S3 Timeout + 100 msec, 5.1 seconds, for the Session Timing parameter to timeout'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            start_tester_present=True,
            expected={
                'response': 'No response'
            }
        )
        tools.timer.input('Wait for 2 minutes...', timeout=120)
        test.preconditions(current_step='- Stop tester present -')
        test.step(step_title='- Stop tester present -',
                    stop_tester_present=True)
        tools.timer.input('Wait for S3 Timeout + 100ms', timeout=6)

    def test_126(self, name='<Verify return to defaultSession>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            custom='28 03 01',
            expected={
                'response': 'Negative',
                'data': '7F'
            }
        )

    def test_127(self, name='<Transition to extendedSession>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            custom='10 03',
            expected={
                'response': 'Positive',
                'dataLength': '4'
            }
        )

    def test_128(self, name='<Activate TesterPresent>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            start_tester_present=True,
            expected={
                'response': 'No response'
            }
        )

    def test_130(self, name='<Start Routine> Physical Address Req'):
        test.preconditions(
            step_info=info()
        )
        if device_under_test is 'MSM':
            test.step(
                step_title=name,
                custom='31 01 02 72 0400000000000000000000000000000077E0D08BC31736345A1678572DF71F22ECA6CA2BBE122DCA54BCC2BB9124BB7055A206D569935E7A7002B21DEA84103D05',
                expected={
                    'response': 'Negative',
                    'data': '33'
                }
            )
        if device_under_test == 'TCP':
            test.step(
                step_title=name,
                custom='31 01 02 C0 00',
                expected={
                    'response': 'Negative',
                    'data': '33'
                }
            )
        if device_under_test in ['PTM','ARB']:
            test.step(
                step_title=name,
                custom='31 01 03 41 00 00',#no suitable rid
                expected={
                    'response': 'Negative',
                    'data': '33'
                }
            )
        if device_under_test is 'SCL':
            print(name, 'Test is not supported by %s'%device_under_test)
    def test_131(self, name='<Unlock Security Level 0D, ServiceProgramming>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            request_seed='0D',
            expected={
                'response': 'Positive',
                'data': self.all_FFs_byte_seed
            }
        )

    def test_132(self, name='<Unlock the Server via security access 0D service>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            send_key='0D',
            expected={
                'response': 'Positive'
            }
        )

    def test_133(self, name='<Verify Server is enforcing ECU Service Programming Routine>'):
        test.preconditions(
            step_info=info()
        )
        if device_under_test is 'MSM':
            test.step(
                step_title=name,
                communication_control=False,
                custom='31 01 02 72 0400000000000000000000000000000077E0D08BC31736345A1678572DF71F22ECA6CA2BBE122DCA54BCC2BB9124BB7055A206D569935E7A7002B21DEA84103D05',
                expected={
                    'response': 'Positive'
                }
            )
        if device_under_test is 'SCL':
            test.step(
                step_title=name,
                custom='31 01 FF 01',
                expected={
                    'response': 'Positive'
                }
            )
        if device_under_test in ['ARB','TCP']:
            test.step(
                step_title=name,
                custom='31 01 02 C0 00',
                expected={
                    'response': 'Positive'
                }
            )
        if device_under_test == 'PTM': 
            test.preconditions(
                step_info=info(),
                signal=['RCIP_RrClsrMtnCtlParmEnblAuth','SrlDat2_Prtctd_PDU',1]                
                ) 
            time.sleep(8)    
            test.step(
                step_title=name,
                custom='31 01 03 41 00 00',
                expected={
                    'response': 'Positive'
                }
            )
    def test_134(self, name='Send valid testerPresent, service 3E, within P3 for 2 minutes + Stop periodically transmitted TesterPresent and wait for S3 Timeout + 100 msec, 5.1 seconds, for the Session Timing parameter to timeout'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            start_tester_present=True,
            expected={
                'response': 'No response'
            }
        )
        tools.timer.input('Wait for 2 minutes...', timeout=120)
        test.preconditions(current_step='- Stop tester present -')
        test.step(step_title='- Stop tester present -',
                    stop_tester_present=True)
        tools.timer.input('Wait for S3 Timeout + 100ms', timeout=6)

    def test_136(self, name='<Verify return to defaultSession>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            custom='28 03 01',
            expected={
                'response': 'Negative',
                'data': '7F'
            }
        )

    def test_137(self, name='<Transition to extendedSession>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            custom='10 03',
            expected={
                'response': 'Positive',
                'dataLength': '4'
            }
        )

    def test_138(self, name='<Activate TesterPresent>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            start_tester_present=True,
            expected={
                'response': 'No response'
            }
        )

    def test_140(self, name='<Start Routine> Physical Address Req'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            custom='31 01 02 00 02 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  55 1B AF A3 B9 5A 64 DF 9B 40 B8 FD 17 A4 74 33 E1 C9 44 E9 18 F2 20 54 B9 E6 B0 65 A8 3E 73 28 3E C4 F4 B2 F3 70 F7 43 52 FF BD B6 83 BE 82 DB 49',
            expected={
                'response': 'Negative',
                'data': '33'
            }
        )

    def test_141(self, name='<Unlock Security Level 11, ServiceProgramming>'):
        test.preconditions(
            step_info=info(),
        )  
        test.step(
            step_title=name,
            communication_control=False,  # updated by HC  add
            request_seed='11',
            expected={
                'response': 'Positive',
                'data': self.all_FFs_byte_seed
            }
        )

    def test_142(self, name='<Unlock the Server via security access 11 service>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            send_key='11',
            expected={
                'response': 'Positive'
            }
        )

    def test_143(self, name='<Verify Server is enforcing ECU Service Programming Routine>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            custom='31 01 02 00 02 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  55 1B AF A3 B9 5A 64 DF 9B 40 B8 FD 17 A4 74 33 E1 C9 44 E9 18 F2 20 54 B9 E6 B0 65 A8 3E 73 28 3E C4 F4 B2 F3 70 F7 43 52 FF BD B6 83 BE 82 DB 49',
            expected={
                'response': 'Positive'
            }
        )

    def test_144(self, name='Send valid testerPresent, service 3E, within P3 for 2 minutes + Stop periodically transmitted TesterPresent and wait for S3 Timeout + 100 msec, 5.1 seconds, for the Session Timing parameter to timeout'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            start_tester_present=True,
            expected={
                'response': 'No response'
            }
        )
        tools.timer.input('Wait for 2 minutes...', timeout=120)
        test.preconditions(current_step='- Stop tester present -')
        test.step(step_title='- Stop tester present -',
                    stop_tester_present=True)
        tools.timer.input('Wait for S3 Timeout + 100ms', timeout=6)

    def test_146(self, name='<Verify return to defaultSession>'):
        test.preconditions(
            step_info=info()
        )
        test.step(
            step_title=name,
            custom='28 03 01',
            expected={
                'response': 'Negative',
                'data': '7F'
            }
        )

    def test_147(self, name='Pyrotechnic ECU Test'):
        pass

    def test_148(self, name='Pyrotechnic ECU Test'):
        pass

    def test_150(self, name='Pyrotechnic ECU Test'):
        pass

    def test_151(self, name='Pyrotechnic ECU Test'):
        pass

    def test_152(self, name='Pyrotechnic ECU Test'):
        pass

    def test_153(self, name='Pyrotechnic ECU Test'):
        pass

    def test_154(self, name='Pyrotechnic ECU Test'):
        pass

    def test_156(self, name='Pyrotechnic ECU Test'):
        pass



